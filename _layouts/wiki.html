---
layout: default
---

{% assign hierarchy = {} %}

<!-- Step 1: Build the Nested Hierarchy -->
{% for post in site.posts %}
  {% assign current = hierarchy %}
  {% assign category = post.category %}

  <!-- Create the category if it doesn't exist -->
  {% if current[category] == nil %}
    {% assign temp = current | merge: { category: {} } %}
    {% assign current = temp %}
  {% endif %}
  {% assign current = current[category] %}

  <!-- Build the tag hierarchy -->
  {% for tag in post.tags %}
    {% if current[tag] == nil %}
      {% assign temp = current | merge: { tag: {} } %}
      {% assign current = temp %}
    {% endif %}
    {% assign current = current[tag] %}
  {% endfor %}

  <!-- Add post to the deepest level -->
  {% if current["posts"] == nil %}
    {% assign temp = current | merge: { "posts": [] } %}
    {% assign current = temp %}
  {% endif %}
  {% assign current["posts"] = current["posts"] | push: post %}
{% endfor %}

<!-- Step 2: Render the Nested Hierarchy -->
<ul>
  {% for category in hierarchy %}
    <li>
      <strong>{{ category }}</strong>
      <ul>
        {% assign tags = hierarchy[category] %}
        {% include render_tags.html tags=tags %}
      </ul>
    </li>
  {% endfor %}
</ul>
